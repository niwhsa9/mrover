<!-- 
    This launch file launches everything necessary to run auton code in the simulator.
 -->
<launch>
    <arg name="rvizconfig" default="$(find mrover)/config/rviz/auton_sim.rviz" />
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(arg rvizconfig)" required="true" />

    <!-- launch rover core nodes -->
    <include file="$(find mrover)/launch/rover_core.launch" />

    <!-- launch the simulator -->
    <include file="$(find mrover)/launch/simulator.launch" />

    <!-- launch auton -->
    <include file="$(find mrover)/launch/auton.launch" />

    <node name="stereo_odometry" pkg="rtabmap_ros" type="stereo_odometry" output="screen">
        <remap from="left/image_rect" to="raw_stereo/left_image" />
        <remap from="right/image_rect" to="raw_stereo/right_image" />
        <remap from="left/camera_info" to="raw_stereo/left_info" />
        <remap from="right/camera_info" to="raw_stereo/right_info" />

        <remap from="odom" to="/odometry" />
        <param name="frame_id" type="string" value="base_link" />
        <param name="odom_frame_id" type="string" value="odom-vis" />

        <param name="Vis/InlierDistance" type="string" value="0.1"/>
        <param name="Vis/MinInliers" type="string" value="20"/>
        <param name="GFTT/MinDistance" type="string" value="7"/>
    </node>
</launch>